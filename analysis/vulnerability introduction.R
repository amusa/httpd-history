library(RODBC)
library(lattice)
conn <- odbcConnect("httpdhistory", uid="httpdhistory", pwd="httpdhistory", case="tolower")

repolog <- sqlQuery(conn, "SELECT * FROM VulnIntroAll")

# Do vulnerability-introducing commits have more total churn?
vulnerable <- repolog$TotalChurn[repolog$VulnIntro=="Yes"]
neutral <- repolog$TotalChurn[repolog$VulnIntro=="No"]
mean(vulnerable)
mean(neutral)
wilcox.test(vulnerable,neutral)

# Does the percentage of interactive churn differ between vulnerability-introducing commits and neutral commits?
vulnerable <- repolog$PercIntChurn[repolog$VulnIntro=="Yes"]
neutral <- repolog$PercIntChurn[repolog$VulnIntro=="No"]
mean(vulnerable)
mean(neutral)
wilcox.test(vulnerable,neutral)

# Does the number of authors affected differ between vulnerability-introducing commits and neutral commits?
vulnerable <- repolog$AuthorsAffected[repolog$VulnIntro=="Yes"]
neutral <- repolog$AuthorsAffected[repolog$VulnIntro=="No"]
mean(vulnerable)
mean(neutral)
wilcox.test(vulnerable,neutral)

#odbcClose(conn)
#rm(conn)